$(document).ready(function(){
	var input=[];
	$("#frm_login").submit(function(e){
		e.preventDefault();
		var email=$("#email").val();
		var password=$("#password").val();

		login_request(email,password);
	});
	$("#frm_add_course").submit(function(e){
		e.preventDefault();
		var course_title=$("#course_title").val();
		var course_price=$("#course_price").val();
		var assigned_teacher=$("#assigned_teacher").val();
		var summary=$(".course_summary").val();
		if(summary.length>=10){
           $.ajax({  
                url:"save_course",  
                method:"POST",  
                data:new FormData(this),  
                contentType:false,  
                processData:false,  
                success:function(data)  
                { 
                  if(data.match("200")){
                    window.location="?request=list_credits";
                  }else{
                    alert(data);
                  }          
                }  
           });
		}else{
			alert("Please Click Again on SAVE COURSE button to confirm action.");
		}
	});

	$("#frm_add_credit").submit(function(e){
		e.preventDefault();
		var summary=$(".credit_summary").val();
		if(summary.length>=10){
           $.ajax({  
                url:"save_credit",  
                method:"POST",  
                data:new FormData(this),  
                contentType:false,  
                processData:false,  
                success:function(data)  
                { 
                  if(data.match("200")){
                    window.location="?request=list_credits";
                  }else{
                    alert(data);
                  }          
                }  
           });
		}else{
			alert("Please Click Again on SAVE CREDIT button to confirm action.");
		}
	});
	var credit_title;
	$("#frm_add_quiz").submit(function(e){
		e.preventDefault();
		var credit_id=$("#credit_id").val();
		var quiz_summary=$(".quiz_summary").val();
		var quiz_title=$("#quiz_title").val();

		input[0]="save_quiz";
		input[1]=credit_id;
		input[2]=quiz_title;
		input[3]=quiz_summary;

		if(quiz_summary.length>=10){
			requestHandling(input,false,'',true,"?request=credit_quiz&title="+credit_title+"&credit="+credit_id);
		}else{
			alert("Please Click Again on SAVE QUIZ button to confirm action.");
		}
	});
	$("#btnAddQuiz").click(function(){
		var credit=$(this).attr("credit");
		credit_title=$(this).attr("title");
		$("#quiz_modal").modal();
		$("#credit_id").val(credit);
	});
	$("#btnQuestions").click(function(){
		var quiz=$(this).attr("quiz");
		var quiz_title=$(this).attr("title");
		$("#question_modal").modal();
		$("#quiz_id").val(quiz);
		$("#question_quiz").html("Quiz: "+quiz_title);
	});
	$("#frm_save_question").submit(function(e){
		e.preventDefault();
		var question_text=$("#question_text").val();
		var answer1=$("#answer1").val();
		var answer2=$("#answer2").val();
		var answer3=$("#answer3").val();
		var answer4=$("#answer4").val();
		var answer5=$("#answer5").val();
		var quiz_id=$("#quiz_id").val();

		input[0]="save_question";
		input[1]=question_text;
		input[2]=answer1;
		input[3]=answer2;
		input[4]=answer3;
		input[5]=answer4;
		input[6]=answer5;
		input[7]=quiz_id;
		requestHandling(input,false,'',false,"?request=credit_quiz&title="+credit_title+"&credit="+credit_id);
	});
	$("ul.answers_list>li>a").click(function(){
		var text=$(this).attr("name");
		var question=$(this).attr("question");
		input[0]="correct_answer";
		input[1]=text;
		input[2]=question;
		requestHandling(input,false,'',false,"?request=credit_quiz");
	});
});

function requestHandling(input,hasLoader,loaderref,has_redirect,redirectUrl){
	var url="request_handler";
	if(hasLoader){
		loaderref.show();
	}
	$.post(url,{
		input:input
	},function(response){
		if(hasLoader){
			loaderref.hide();
		}
		if(response.match("200")){
			if(has_redirect){
				window.location=redirectUrl;
			}else{
				location.reload();
			}
		}else{
			alert(response);
		}
	});
}
function login_request(email,password){
	$.post("login_request",{
		email:email,
		password:password
	},function(response){
		if(response.match("200")){
			window.location="index";
		}else{
			alert(response);
			console.log(response);
		}
	});
}